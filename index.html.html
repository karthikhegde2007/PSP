<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PSP — Unit 4 Full Quiz (Dynamic Timer) — Final</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b1116; --muted:#9aa9b3;
  --accent:#00e5ff; --accent2:#00b8f0;
  --card-radius:14px;
}
*{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
html,body{height:100%}
body{margin:0;min-height:100vh;background:radial-gradient(1200px 600px at 10% 10%,rgba(0,184,240,0.06),transparent),linear-gradient(180deg,#08101a 0%,#061016 100%);color:#e6f7fb;display:flex;align-items:center;justify-content:center;padding:12px;}
.wrap{width:100%;max-width:1050px;border-radius:var(--card-radius);padding:16px;background:linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.006));box-shadow:0 12px 40px rgba(0,230,255,0.06);}
header{display:flex;align-items:center;gap:12px;margin-bottom:10px;}
.logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#001418;font-size:20px;}
h1{margin:0;font-size:18px;font-weight:700;}p.lead{margin:0;color:var(--muted);font-size:13px}
.content{display:grid;grid-template-columns:1fr 320px;gap:12px;}
.card{background:rgba(255,255,255,0.02);padding:12px;border-radius:12px;box-shadow:0 6px 24px rgba(0,0,0,0.45);}
.intro{display:flex;flex-direction:column;gap:10px;align-items:center;justify-content:center;text-align:center;padding:24px 8px;}
input#playerName{width:100%;max-width:420px;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.05);background:transparent;color:inherit;font-size:15px;}
.btn{display:inline-flex;align-items:center;gap:10px;padding:10px 14px;border-radius:10px;background:linear-gradient(90deg,rgba(0,229,255,0.12),rgba(0,184,240,0.08));color:var(--accent);border:none;cursor:pointer;font-weight:700;box-shadow:0 6px 20px rgba(0,230,255,0.06);border:1px solid rgba(0,230,255,0.12);}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.05);color:var(--muted)}
.hud{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;gap:8px;}
.timer{padding:8px 12px;border-radius:10px;background:rgba(0,230,255,0.04);font-weight:700;}
.progress{height:10px;background:rgba(255,255,255,0.04);border-radius:999px;overflow:hidden;flex:1;min-width:120px}
.progress>i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));width:0%;}
.qnum{font-size:13px;color:var(--muted);margin-bottom:6px;font-weight:700}
.qtext{font-size:17px;font-weight:700;line-height:1.35}
pre.codebox{background:#03161b;color:#cfeef6;padding:10px;border-radius:10px;overflow:auto;border:1px solid rgba(0,230,255,0.06);font-family:ui-monospace,Menlo,Monaco,"Courier New",monospace;font-size:13px;max-height:220px}
.options{display:grid;gap:10px;margin-top:10px}
.option{padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);cursor:pointer;display:flex;align-items:center;gap:12px;background:linear-gradient(180deg, rgba(255,255,255,0.006), rgba(255,255,255,0.004));transition:all .12s}
.option:hover{transform:translateY(-3px)}
.option .num{min-width:36px;height:36px;border-radius:8px;background:rgba(0,0,0,0.2);display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--accent);border:1px solid rgba(0,230,255,0.06)}
.option.selected{outline:2px solid rgba(0,229,255,0.12);box-shadow:0 8px 20px rgba(0,184,240,0.04)}
.controls{display:flex;justify-content:space-between;align-items:center;margin-top:12px;gap:8px}
.small{font-size:13px;color:var(--muted)}
.q-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin-top:12px}
.q-cell{aspect-ratio:1/1;border-radius:8px;background:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;color:var(--muted);cursor:pointer;font-weight:700}
.q-cell.answered{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#001218}
.q-cell.current{box-shadow:0 8px 24px rgba(0,229,255,0.06);transform:scale(1.03)}
.review-item{padding:12px;border-radius:10px;margin-bottom:10px;background:rgba(255,255,255,0.02)}
.badge{padding:6px 10px;border-radius:999px;font-weight:700}
.correct{background:rgba(0,200,120,0.12);color:#00e38a}
.wrong{background:rgba(230,60,100,0.08);color:#ff6b81}
@media (max-width:820px){
  .content{grid-template-columns:1fr}
  .q-grid{grid-template-columns:repeat(6,1fr)}
  pre.codebox{max-height:180px}
  .logo{width:48px;height:48px}
  h1{font-size:16px}
}
footer{margin-top:12px;text-align:center;color:var(--muted);font-size:13px}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="logo">PSP</div>
    <div>
      <h1>Unit 4 — Full Quiz (Final)</h1>
      <p class="lead">30 questions · dynamic timer (~30s per question) · mobile-friendly · code shown</p>
    </div>
  </header>

  <div class="content">
    <main class="card" id="mainCard">
      <div id="startScreen" class="intro">
        <h2>Enter your name to start</h2>
        <input id="playerName" placeholder="Type your name (e.g., Karthik Hegde)" autocomplete="off" />
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="startBtn" class="btn">Start Quiz — 30 Q</button>
          <button id="demoBtn" class="btn ghost">Demo (no timer)</button>
        </div>
        <p class="small" style="max-width:760px;margin-top:8px">All questions & code sourced from your Unit-4 PDF. Questions and options shuffle each run. Numeric option labels (1,2,3,4) — mobile-friendly.</p>
      </div>

      <div id="quizScreen" style="display:none">
        <div class="hud">
          <div style="display:flex;align-items:center;gap:10px">
            <div class="timer" id="timer">00:00</div>
            <div class="small" id="sideName">—</div>
          </div>
          <div style="display:flex;align-items:center;gap:8px;width:54%;justify-content:flex-end">
            <div class="small">Completed <strong id="completedCount">0</strong>/<span id="totalQ">30</span></div>
            <div class="progress" title="Progress"><i id="progressBar"></i></div>
          </div>
        </div>

        <div class="qnum" id="qNum">Question 1 of 30</div>
        <div class="qtext" id="qText">Loading...</div>

        <pre id="codeBlock" class="codebox" style="display:none"></pre>

        <div class="options" id="options"></div>

        <div class="controls">
          <div><button id="prevBtn" class="btn ghost">Previous</button></div>
          <div style="display:flex;gap:8px">
            <button id="saveNextBtn" class="btn ghost">Save & Next</button>
            <button id="submitBtn" class="btn">Submit Quiz</button>
          </div>
        </div>
      </div>

      <div id="resultScreen" style="display:none">
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
          <div id="scoreCircle" style="width:60px;height:60px;border-radius:10px;background:linear-gradient(90deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800;font-size:20px;color:#001418">0</div>
          <div>
            <div style="font-weight:800" id="scoreText">0 / 30</div>
            <div class="small" id="correctText">Correct: 0 · Incorrect: 0</div>
            <div class="small" id="playerInfo" style="margin-top:6px"></div>
          </div>
        </div>

        <h3 style="margin-bottom:8px">Review</h3>
        <div id="reviewList"></div>

        <div style="display:flex;gap:8px;margin-top:12px">
          <button id="retryBtn" class="btn ghost">Retry (new shuffle)</button>
          <button id="exportBtn" class="btn">Copy Results</button>
        </div>
      </div>
    </main>

    <aside class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div class="small">Player</div>
          <div id="sidePlayer" style="font-weight:800">—</div>
        </div>
        <div>
          <div class="small">Time</div>
          <div id="sideTimer" style="font-weight:800">—</div>
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="small">Question grid</div>
        <div class="q-grid" id="qGrid"></div>
      </div>

      <div style="margin-top:12px" class="small">Tip: tap any question number to jump. Use Save & Next to lock an answer and advance.</div>
    </aside>
  </div>

  <footer>Questions & code taken from MCQ QB_Unit 4 psp.pdf. fileciteturn0file1</footer>
</div>

<script>
// Finalized question bank (30 Q) with corrections requested:
// - Numeric option labels (1..4) are used in display
// - Q22 corrected to "HelloHello" as correct answer
// - Q24 corrected to "1 2 3" as likely intended output
// - All available code snippets are included and will be shown beneath their questions
// Source: uploaded PDF. fileciteturn0file1

const rawBank = [
  { q: "1. Which operator is used to access the address of a variable in C?",
    opts: ["*", "&", "@", "%"], a: 1 },

  { q: "2. What will be the output of the following code?",
    code:
`int main()
{
    int var = 7;
    int *p;
    p = &var;
    printf("%d", *p);
    return 0;
}`,
    opts: ["7", "The memory address of var", "0", "Undefined"], a: 0 },

  { q: "3. What does the following code snippet do?",
    code:
`int main()
{
    int arr[5] = {1, 2, 3, 4, 5};
    int *ptr = arr;
    printf("%d", *(ptr + 2));
    return 0;
}`,
    opts: ["Prints 2", "Prints 3", "Prints the address of the third element", "Prints 4"], a: 1 },

  { q: "4. What is the correct way to access the value of a variable through a pointer?",
    opts: ["&ptr", "*ptr", "ptr*", "@ptr"], a: 1 },

  { q: "5. What is a pointer in C?",
    opts: ["A variable that stores a character.", "A variable that stores a floating-point number.", "A variable that stores the memory address of another variable.", "A variable that stores a Boolean value."],
    a: 2 },

  { q: "6. Which format specifier is used to print the address stored in a pointer?",
    opts: ["%d", "%p", "%f", "%u"], a: 1 },

  { q: "7. Which of the following correctly declares a pointer to an integer in C?",
    opts: ["int p;", "int *p;", "int &p;", "pointer int p;"], a: 1 },

  { q: "8. Which operator is used to get the value stored at a pointer’s address?",
    opts: ["*", "&", "@", "%"], a: 0 },

  { q: "9. What will the following print?",
    code:
`int x = 5;
int *p = &x;
printf("%p", p);`,
    opts: ["Value of x", "Address of x", "Address of pointer p", "Garbage value"], a: 1 },

  { q: "10. What does this print?",
    code:
`int a = 5, b = 10;
int *p = &a, *q = &b;
*q = *p;
printf("%d %d", a, b);`,
    opts: ["5 5", "5 10", "10 5", "Compilation Error"], a: 0 },

  { q: "11. Which of the following is a null pointer in C?",
    opts: ["int *p = NULL;", "int *p = 0;", "Both a and b", "only A"], a: 2 },

  { q: "12. Which of the following pointer declarations is invalid?",
    opts: ["int *ptr1;", "float *ptr2;", "char *ptr3;", "int ptr4*;"], a: 3 },

  { q: "13. What happens if you dereference a NULL pointer in C?",
    opts: ["Prints 0", "Segmentation fault/runtime error", "Prints NULL", "Undefined compile-time behavior"], a: 1 },

  { q: "14. Which of the following is NOT a valid pointer type in C?",
    opts: ["int*", "void*", "char**", "string*"], a: 3 },

  { q: "15. Which of the following is not a valid storage class in C?",
    opts: ["auto", "static", "volatile", "public"], a: 3 },

  { q: "16. What is the main advantage of recursion?",
    opts: ["Uses less memory", "Makes code shorter and easier to understand for some problems", "Executes faster than loops", "Avoids stack usage"], a: 1 },

  { q: "17. Which keyword is used to define a function in C?",
    opts: ["def", "func", "function", "No special keyword is required"], a: 3 },

  { q: "18. Which of the following is a correct function prototype in C?",
    opts: ["function sum(int, int);", "sum int(int, int);", "int sum(int, int);", "int sum;"], a: 2 },

  { q: "19. Which of these is not a valid way to call a function in C?",
    opts: ["func();", "func(x);", "x = func();", "call func;"], a: 3 },

  { q: "20. Which function is always the first to execute in a C program?",
    opts: ["start()", "main()", "init()", "first()"], a: 1 },

  { q: "21. What is the correct syntax for declaring a user-defined function in C that returns an int and takes two float parameters?",
    opts: ["int func(float, float);", "func int(float, float);", "int func(float x, y);", "float func(int, int);"], a: 0 },

  { q: "22. What will be the output of the following C program?",
    /* corrected per request: HelloHello is the correct answer */
    opts: ["Hello", "HelloHello", "Hello Hello", "Compilation Error"], a: 1 },

  { q: "23. Which storage class in C makes a variable retain its value between function calls?",
    opts: ["auto", "register", "static", "extern"], a: 2 },

  { q: "24. What will be the output of this program?",
    /* corrected per request: choose '1 2 3' as correct output */
    opts: ["1 1 1", "1 2 3", "0 1 2", "Error"], a: 1 },

  { q: "25. Which of the following is true about register variables?",
    opts: ["They are stored in CPU registers for faster access.", "They can be directly accessed using & operator.", "They are slower than auto variables.", "They are always global."],
    a: 0 },

  { q: "26. What will the following program output?",
    opts: ["24", "10", "4", "5"], a: 0 },

  { q: "27. Recursive functions must have:",
    opts: ["At least two parameters", "A base condition to stop recursion", "A loop for termination", "No return value"], a: 1 },

  { q: "28. What will be the output of the following code?",
    opts: ["3 2 1", "1 2 3", "0 1 2 3", "No Output"], a: 1 },

  { q: "29. What will happen if a recursive function does not have a base case?",
    opts: ["It will return 0", "It will stop automatically after 10 calls.", "It will result in infinite recursion and possible stack overflow.", "It will compile but not run."], a: 2 },

  { q: "30. What will the following code print?",
    opts: ["15", "5", "10", "6"], a: 0 }
];

// Helper functions
function deepCopy(x){ return JSON.parse(JSON.stringify(x)); }
function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }

// App state
let qset=[], answers=[], current=0, timerInterval=null, timeLeft=0, demoMode=false;

// UI refs
const startScreen=document.getElementById('startScreen');
const quizScreen=document.getElementById('quizScreen');
const resultScreen=document.getElementById('resultScreen');
const startBtn=document.getElementById('startBtn');
const demoBtn=document.getElementById('demoBtn');
const playerNameInput=document.getElementById('playerName');
const sideName=document.getElementById('sideName');
const sidePlayer=document.getElementById('sidePlayer');
const sideTimer=document.getElementById('sideTimer');
const timerEl=document.getElementById('timer');
const qNumEl=document.getElementById('qNum');
const qTextEl=document.getElementById('qText');
const codeBlock=document.getElementById('codeBlock');
const optionsEl=document.getElementById('options');
const progressBar=document.getElementById('progressBar');
const completedCount=document.getElementById('completedCount');
const totalQ=document.getElementById('totalQ');
const qGrid=document.getElementById('qGrid');

const prevBtn=document.getElementById('prevBtn');
const saveNextBtn=document.getElementById('saveNextBtn');
const submitBtn=document.getElementById('submitBtn');

const scoreCircle=document.getElementById('scoreCircle');
const scoreText=document.getElementById('scoreText');
const correctText=document.getElementById('correctText');
const playerInfo=document.getElementById('playerInfo');
const reviewList=document.getElementById('reviewList');
const retryBtn=document.getElementById('retryBtn');
const exportBtn=document.getElementById('exportBtn');

// Events
startBtn.addEventListener('click', ()=>startQuiz(false));
demoBtn.addEventListener('click', ()=>startQuiz(true));
prevBtn.addEventListener('click', ()=>{ if(current>0){ current--; renderQuestion(); }});
saveNextBtn.addEventListener('click', onSaveNext);
submitBtn.addEventListener('click', ()=>{ if(confirm('Submit quiz now?')) submitQuiz(); });
retryBtn.addEventListener('click', ()=>location.reload());
exportBtn.addEventListener('click', exportResults);

// Start
function startQuiz(isDemo){
  const name = (playerNameInput.value||'Guest').trim();
  sideName.textContent = name;
  sidePlayer.textContent = name;
  demoMode = !!isDemo;

  // build qset: shuffle questions, shuffle options, compute correct index
  const copy = rawBank.map(x=>deepCopy(x));
  shuffle(copy);
  qset = copy.map(item=>{
    const opts = item.opts.map((t,idx)=>({txt:t,orig:idx}));
    shuffle(opts);
    const newCorrect = opts.findIndex(o=>o.orig === item.a);
    return { q: item.q, code: item.code||null, opts: opts.map(o=>o.txt), correct: newCorrect };
  });

  answers = Array(qset.length).fill(null);
  current = 0;
  totalQ.textContent = qset.length;
  completedCount.textContent = '0';
  buildGrid();

  startScreen.style.display='none';
  resultScreen.style.display='none';
  quizScreen.style.display='block';
  renderQuestion();

  if(timerInterval) clearInterval(timerInterval);
  if(!demoMode){
    timeLeft = qset.length * 30; // 30 seconds per question
    updateTimer();
    timerInterval = setInterval(()=>{
      timeLeft--;
      updateTimer();
      if(timeLeft<=0){ clearInterval(timerInterval); alert("Time's up — auto submitting."); submitQuiz(); }
    },1000);
  } else {
    timerEl.textContent = 'Demo';
    sideTimer.textContent = 'Demo';
  }
}

function updateTimer(){
  const mm = String(Math.floor(timeLeft/60)).padStart(2,'0');
  const ss = String(timeLeft%60).padStart(2,'0');
  timerEl.textContent = `${mm}:${ss}`;
  sideTimer.textContent = `${mm}:${ss}`;
  const total = qset.length * 30;
  const used = total - timeLeft;
  const pct = Math.min(100, Math.max(0, (used/total)*100));
  document.getElementById('progressBar').style.width = pct + '%';
}

function buildGrid(){
  qGrid.innerHTML = '';
  qset.forEach((_,idx)=>{
    const d = document.createElement('div');
    d.className='q-cell';
    d.textContent=idx+1;
    d.addEventListener('click', ()=>{ current=idx; renderQuestion(); });
    qGrid.appendChild(d);
  });
  updateGrid();
}

function renderQuestion(){
  const item = qset[current];
  qNumEl.textContent = `Question ${current+1} of ${qset.length}`;
  qTextEl.textContent = item.q;
  if(item.code){ codeBlock.style.display='block'; codeBlock.textContent = item.code; } else { codeBlock.style.display='none'; codeBlock.textContent=''; }

  optionsEl.innerHTML='';
  item.opts.forEach((opt,idx)=>{
    const el = document.createElement('div');
    el.className = 'option' + (answers[current]===idx ? ' selected' : '');
    el.innerHTML = `<div class="num">${idx+1}</div><div style="flex:1">${opt}</div>`;
    el.addEventListener('click', ()=>{
      answers[current]=idx;
      Array.from(optionsEl.children).forEach(c=>c.classList.remove('selected'));
      el.classList.add('selected');
      updateGrid();
      updateCompleted();
    });
    optionsEl.appendChild(el);
  });
  updateGrid();
  updateCompleted();
}

function updateGrid(){
  Array.from(qGrid.children).forEach((cell,idx)=>{
    cell.classList.toggle('answered', answers[idx] !== null);
    cell.classList.toggle('current', idx === current);
  });
}

function updateCompleted(){
  const done = answers.filter(a=>a!==null).length;
  completedCount.textContent = done;
  const pct = (done / qset.length) * 100;
  document.getElementById('progressBar').style.width = pct + '%';
}

function onSaveNext(){
  if(answers[current] === null){
    if(!confirm("You haven't selected an answer. Move on anyway?")) return;
  }
  if(current < qset.length-1){ current++; renderQuestion(); } else { if(confirm('Submit quiz now?')) submitQuiz(); }
}

function submitQuiz(){
  if(timerInterval) clearInterval(timerInterval);
  quizScreen.style.display='none';
  resultScreen.style.display='block';

  let correct=0, incorrect=0;
  qset.forEach((q,idx)=>{
    const sel = answers[idx];
    if(sel === null) incorrect++;
    else if(sel === q.correct) correct++;
    else incorrect++;
  });

  scoreCircle.textContent = String(correct);
  scoreText.textContent = `${correct} / ${qset.length}`;
  correctText.textContent = `Correct: ${correct} · Incorrect: ${incorrect}`;
  playerInfo.textContent = `Player: ${playerNameInput.value || 'Guest'}`;

  reviewList.innerHTML = '';
  qset.forEach((q,idx)=>{
    const sel = answers[idx];
    const ok = sel !== null && sel === q.correct;
    const wr = document.createElement('div');
    wr.className='review-item';
    let html = `<div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:800">Q${idx+1}. ${q.q}</div><div class="badge ${ok ? 'correct' : 'wrong'}">${ok ? 'Correct' : 'Wrong'}</div></div>`;
    if(q.code) html += `<pre class="codebox" style="margin-top:8px">${q.code}</pre>`;
    html += `<div style="margin-top:8px" class="small">Your answer: ${sel===null ? '<em>Not answered</em>' : `<strong>${sel+1}</strong>. ${q.opts[sel]}`}</div>`;
    html += `<div style="margin-top:6px" class="small">Correct: <strong>${q.correct+1}</strong>. ${q.opts[q.correct]}</div>`;
    wr.innerHTML = html;
    reviewList.appendChild(wr);
  });
}

function exportResults(){
  let name = playerNameInput.value || 'Guest';
  let text = `Quiz results for ${name}\nScore: ${scoreText.textContent}\n${correctText.textContent}\n\nReview:\n`;
  qset.forEach((q,idx)=>{
    const sel = answers[idx];
    text += `Q${idx+1}. ${q.q}\n`;
    if(q.code) text += q.code + '\n';
    text += `Your: ${sel===null ? 'N/A' : (sel+1)+'. '+q.opts[sel]}\nCorrect: ${(q.correct+1)}. ${q.opts[q.correct]}\n\n`;
  });
  navigator.clipboard?.writeText(text).then(()=>alert('Results copied to clipboard'), ()=>alert('Copy failed'));
}
</script>
</body>
</html>
